<!DOCTYPE html>
<html lang="en">

<title>PHYS S-12: I/O Devices</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/css/bootstrap.min.css" rel="stylesheet">
<link href="../style.css" rel="stylesheet">

<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/arduino-light.min.css">
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.8.0/highlight.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/arduino.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
  
<nav class="navbar navbar-expand-sm navbar-light bg-light">
  <div style="align-items: left; justify-content:left;" class="container-fluid">
    <h3 class="nav-title"> PHYS S-12: I/O Devices</h3>
    <div class="navbar-nav">
      <h4></h4>
      <h4><a class="nav-link" href="../index.html">Home</a></h4>
      <h4><a class="nav-link" href="../about.html">About</a></h4>
    </div>
  </div>
</nav>

<body>

<xmp style="display:none;">
<br> 

#### Class 6: Input Devices
  
 In class, on Tuesday the 11th, we learned about several different sensors, input devices, and coding techniques. Using the data and code provided on the class website, I was able to build working circuits for heat sensors and light sensors.
<p>For the first part of the class assignment, I attempted to calibrate a magnetic field sensor. I started by wiring the circuit from the course website. Then I wrote the code below to read the signal from the hall sensor. When trying to calibrate the maximum and minimum of the sensor, I discovered that it is quite sensitive for distances above 1 mm and less than 9 mm. According to the data table below, the practical range is around 2 to 8 mm. </p>
<p>
   <pre><code class="language-arduino">
     void setup(){
 Serial.begin(9600);
}
   // read the value given 
 void loop(){
  int val = analogRead(A0);  // read Hall sensor value
 }
 </code></pre>
</p>
<img src=../pictures/Ccode.png width="237" height="317">
<img src=../pictures/design.png width="237" height="317">
<img src=../pictures/design.png width="422" height="318">
<img src=../pictures/design.png width="237" height="317">
<img src=../pictures/design.png width="237" height="317">
<img src=../pictures/design.png width="237" height="317">

<p>    
</p>
  <p>For the second part of my input device assignment, I decided to build my own capacitive throttle sensor. I used two popsicle sticks, two pieces of copper sticker, foam, masking tape, and wires. First, I stuck wires onto the two piece of copper and then on the popsicle sticks, sandwiching the wires to the sticks. Then, I taped the popsicle sticks together on the opposite side, having the copper sheets facing each other (tape on one end, copper on the other). Next, I pushed a piece of foam between the popsicle sticks as close to the tape as possible. This separated the popsicle sticks giving me enough room to tape another piece of foam between the two copper sheets. Finally, I plugged in the code, and I had myself a throttle!! </p>
<p> 
<img src=../pictures/Ccode.png width="237" height="317">
<img src=../pictures/design.png width="237" height="317">
<img src=../pictures/design.png width="422" height="318">

</p>
  <p>
  <pre><code class="language-arduino">
 //Code for Throttle:

long result;   //variable for the result of the tx_rx measurement.
int analog_pin = A3;
int tx_pin = 4;

void setup() {
    pinMode(tx_pin, OUTPUT);      //Pin 4 provides the voltage step
    Serial.begin(9600);
}

void loop() {
    result = tx_rx();
    Serial.println(result);
}

long tx_rx(){         // Function to execute rx_tx algorithm and return a value
                      // that depends on coupling of two electrodes.
                      // Value returned is a long integer.
  int read_high;
  int read_low;
  int diff;
  long int sum;
  int N_samples = 100;    // Number of samples to take.  Larger number slows it down, but reduces scatter.

  sum = 0;

  for (int i = 0; i < N_samples; i++){
   digitalWrite(tx_pin,HIGH);              // Step the voltage high on conductor 1.
   read_high = analogRead(analog_pin);     // Measure response of conductor 2.
   delayMicroseconds(100);                 // Delay to reach steady state.
   digitalWrite(tx_pin,LOW);               // Step the voltage to zero on conductor 1.
   read_low = analogRead(analog_pin);      // Measure response of conductor 2.
   diff = read_high - read_low;            // desired answer is the difference between high and low.
   sum += diff;                            // Sums up N_samples of these measurements.
 }
  return sum;
}                                          // End of tx_rx function.

  </code></pre>
</p>

</body>

  
<body>
  <p>After I programed the lights, I built my circuit for my microprogramming assignment. I wanted Mr. Bike Man to bike forwards at an average rate, then, with the button pressed, bike backwards slowly with a hazard LED light flashing in the back. After many attempts, and a few circuit changes, I finally got him to work! Below are the pictures of the circuit set-up and the finished microprograming assignment. Underneath the pictures is the code I used to program Mr. Bike Man. </p>
<img src=../pictures/mpc1.png width="237" height="318">
<img src=../pictures/mpc2.png width="380" height="250">
<img src=../pictures/mpc3.png width="380" height="250">
<img src=../pictures/mpc4.png width="380" height="250">
<img src=../pictures/mpc5.png width="380" height="250">
<img src=../pictures/mpc6.png width="380" height="250">
<img src=../pictures/mpc7.png width="380" height="250">
<img src=../pictures/mpc8.png width="237" height="318">
<img src=../pictures/mpc9.png width="380" height="250">
<video width="380" height="250" controls>
  <source src="../pictures/mpc_vid.mov" type="video/mp4">
</video>
  
  <p>
  <pre><code class="language-arduino">
  const int motorPin1 = 3;  // define pin 3 for A-1A (PWM Speed)
const int motorPin2 = 4;  // define pin 4 for A-1B (direction)
const int LEDPin1 = 5;    // LED Pin Output
const int buttonPin = 2;  // define pin 2 for button state input
int buttonState = 0;

// Setup i/o pins on board
void setup() {
  // specify these pins as inputs
  pinMode(buttonPin, INPUT);
  
  // specify these pins as outputs
  pinMode(motorPin1, OUTPUT); 
  pinMode(motorPin2, OUTPUT);
  pinMode(LEDPin1, OUTPUT); 
  }

// Function to turn on the motor in a clockwise direction
// input: speed as integer from 0 to 255
void motorForward( int speed ) {
  // Set Motor speed
  analogWrite(motorPin1, speed); 
  digitalWrite(motorPin2, HIGH);

  // Turn off LEDs
  digitalWrite(LEDPin1, LOW);
}

// Function to turn on the motor in a counter clockwise direction
// input: speed as integer from 0 to 255
void motorReverse( int speed ) {
  // Set motor speed
  analogWrite(motorPin1, speed); 
  digitalWrite(motorPin2, LOW);
  
  // Turn on LEDs
  digitalWrite(LEDPin1, HIGH);
}

// Main loop function for board
void loop() {
  // Read the current button state
  buttonState = digitalRead(buttonPin);
  
  // If the button is not pressed
  if (buttonState == LOW) {
    // start the motor forward at a low speed
    motorForward(150);
  }
  
  else {
    // start the motor in reverse at a low speed
    motorReverse(70);
  }  
  
  // Add a quick delay in case of direction change on next button press
  delay(1000);  
}
  </code></pre>
</p>
  
</xmp>
</body>

<script src="../strapdown.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" ></script>

</html>
